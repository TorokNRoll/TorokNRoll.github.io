<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: merkle_ambiguity Pages: 1 -->
<svg width="910pt" height="504pt"
 viewBox="0.00 0.00 910.00 504.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 500)">
<title>merkle_ambiguity</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-500 906,-500 906,4 -4,4"/>
<text text-anchor="middle" x="451" y="-7.8" font-family="Times,serif" font-size="14.00">The same merkle root derived from two different sets of transactions. &#160;Based on research by Suhas Daftuar</text>
<g id="clust1" class="cluster"><title>cluster_invalid</title>
<polygon fill="none" stroke="black" points="8,-31 8,-488 342,-488 342,-31 8,-31"/>
<text text-anchor="middle" x="175" y="-38.8" font-family="Times,serif" font-size="14.00">Merkle tree referencing an invalid transaction</text>
</g>
<g id="clust4" class="cluster"><title>cluster_valid</title>
<polygon fill="none" stroke="black" points="350,-31 350,-488 894,-488 894,-31 350,-31"/>
<text text-anchor="middle" x="622" y="-38.8" font-family="Times,serif" font-size="14.00">Merkle tree referencing two valid transactions</text>
</g>
<!-- root0 -->
<g id="node1" class="node"><title>root0</title>
<polygon fill="none" stroke="black" points="268,-480 188,-480 188,-444 268,-444 268,-480"/>
<text text-anchor="middle" x="228" y="-458.3" font-family="Times,serif" font-size="14.00">e5e7...c429</text>
</g>
<!-- tx64 -->
<g id="node2" class="node"><title>tx64</title>
<polygon fill="none" stroke="black" points="334,-364 122,-364 122,-296 334,-296 334,-364"/>
<text text-anchor="middle" x="228" y="-348.8" font-family="Times,serif" font-size="14.00">????????01??????????????????????</text>
<text text-anchor="middle" x="228" y="-333.8" font-family="Times,serif" font-size="14.00">????????????????????????????????</text>
<text text-anchor="middle" x="228" y="-318.8" font-family="Times,serif" font-size="14.00">??????????????????00????????01??</text>
<text text-anchor="middle" x="228" y="-303.8" font-family="Times,serif" font-size="14.00">??????????????04????????????????</text>
</g>
<!-- hashop0 -->
<g id="node3" class="node"><title>hashop0</title>
<polygon fill="none" stroke="black" points="228,-422 179.495,-404 228,-386 276.505,-404 228,-422"/>
<text text-anchor="middle" x="228" y="-400.9" font-family="Times,serif" font-size="12.00">sha256d</text>
</g>
<!-- tx64&#45;&gt;hashop0 -->
<g id="edge17" class="edge"><title>tx64&#45;&gt;hashop0</title>
<path fill="none" stroke="black" d="M228,-364.05C228,-367.938 228,-371.873 228,-375.671"/>
<polygon fill="black" stroke="black" points="224.5,-375.86 228,-385.86 231.5,-375.86 224.5,-375.86"/>
</g>
<!-- hashop0&#45;&gt;root0 -->
<g id="edge18" class="edge"><title>hashop0&#45;&gt;root0</title>
<path fill="none" stroke="black" d="M228,-422.106C228,-425.797 228,-429.787 228,-433.757"/>
<polygon fill="black" stroke="black" points="224.5,-433.999 228,-443.999 231.5,-433.999 224.5,-433.999"/>
</g>
<!-- invis0 -->
<!-- invis1 -->
<!-- invis0&#45;&gt;invis1 -->
<!-- invis2 -->
<!-- invis1&#45;&gt;invis2 -->
<!-- invis3 -->
<!-- invis2&#45;&gt;invis3 -->
<!-- invis3&#45;&gt;tx64 -->
<!-- labelb2 -->
<!-- labelb3 -->
<!-- labelb2&#45;&gt;labelb3 -->
<!-- labelb4 -->
<!-- labelb3&#45;&gt;labelb4 -->
<!-- labelb5 -->
<!-- labelb4&#45;&gt;labelb5 -->
<!-- labelb6 -->
<g id="node12" class="node"><title>labelb6</title>
<text text-anchor="middle" x="60" y="-333.8" font-family="Times,serif" font-size="14.00">Fake 64&#45;byte</text>
<text text-anchor="middle" x="60" y="-318.8" font-family="Times,serif" font-size="14.00">transaction</text>
</g>
<!-- labelb5&#45;&gt;labelb6 -->
<!-- labelb7 -->
<!-- labelb6&#45;&gt;labelb7 -->
<!-- labelb8 -->
<g id="node14" class="node"><title>labelb8</title>
<text text-anchor="middle" x="60" y="-458.3" font-family="Times,serif" font-size="14.00">Merkle root</text>
</g>
<!-- labelb7&#45;&gt;labelb8 -->
<!-- label2 -->
<g id="node15" class="node"><title>label2</title>
<text text-anchor="middle" x="828" y="-76.3" font-family="Times,serif" font-size="14.00">Valid transactions</text>
</g>
<!-- label3 -->
<!-- label2&#45;&gt;label3 -->
<!-- label4 -->
<g id="node17" class="node"><title>label4</title>
<text text-anchor="middle" x="851" y="-200.8" font-family="Times,serif" font-size="14.00">Txids for</text>
<text text-anchor="middle" x="851" y="-185.8" font-family="Times,serif" font-size="14.00">valid txes</text>
</g>
<!-- label3&#45;&gt;label4 -->
<!-- label5 -->
<!-- label4&#45;&gt;label5 -->
<!-- label6 -->
<g id="node19" class="node"><title>label6</title>
<text text-anchor="middle" x="822" y="-341.3" font-family="Times,serif" font-size="14.00">Legitimate 64&#45;byte</text>
<text text-anchor="middle" x="822" y="-326.3" font-family="Times,serif" font-size="14.00">preimage</text>
<text text-anchor="middle" x="822" y="-311.3" font-family="Times,serif" font-size="14.00">containing two txids</text>
</g>
<!-- label5&#45;&gt;label6 -->
<!-- label7 -->
<!-- label6&#45;&gt;label7 -->
<!-- label8 -->
<g id="node21" class="node"><title>label8</title>
<text text-anchor="middle" x="822" y="-458.3" font-family="Times,serif" font-size="14.00">Merkle root</text>
</g>
<!-- label7&#45;&gt;label8 -->
<!-- tx1 -->
<g id="node22" class="node"><title>tx1</title>
<polygon fill="none" stroke="black" points="733,-98 651,-98 651,-62 733,-62 733,-98"/>
<text text-anchor="middle" x="692" y="-76.3" font-family="Times,serif" font-size="14.00">0200...1234</text>
</g>
<!-- hashop3 -->
<g id="node30" class="node"><title>hashop3</title>
<polygon fill="none" stroke="black" points="692,-156 643.495,-138 692,-120 740.505,-138 692,-156"/>
<text text-anchor="middle" x="692" y="-134.9" font-family="Times,serif" font-size="12.00">sha256d</text>
</g>
<!-- tx1&#45;&gt;hashop3 -->
<g id="edge22" class="edge"><title>tx1&#45;&gt;hashop3</title>
<path fill="none" stroke="black" d="M692,-98.1061C692,-101.797 692,-105.787 692,-109.757"/>
<polygon fill="black" stroke="black" points="688.5,-109.999 692,-119.999 695.5,-109.999 688.5,-109.999"/>
</g>
<!-- txid1 -->
<g id="node23" class="node"><title>txid1</title>
<polygon fill="none" stroke="black" points="798,-216 586,-216 586,-178 798,-178 798,-216"/>
<text text-anchor="middle" x="692" y="-200.8" font-family="Times,serif" font-size="14.00">??????????????????00????????01??</text>
<text text-anchor="middle" x="692" y="-185.8" font-family="Times,serif" font-size="14.00">??????????????04????????????????</text>
</g>
<!-- concat -->
<g id="node31" class="node"><title>concat</title>
<polygon fill="none" stroke="black" points="549,-274 486.137,-256 549,-238 611.863,-256 549,-274"/>
<text text-anchor="middle" x="549" y="-252.9" font-family="Times,serif" font-size="12.00">concatenate</text>
</g>
<!-- txid1&#45;&gt;concat -->
<g id="edge24" class="edge"><title>txid1&#45;&gt;concat</title>
<path fill="none" stroke="black" d="M646.754,-216.035C626.268,-224.201 602.443,-233.697 583.443,-241.271"/>
<polygon fill="black" stroke="black" points="581.984,-238.085 573.99,-245.039 584.576,-244.587 581.984,-238.085"/>
</g>
<!-- hashop2 -->
<g id="node24" class="node"><title>hashop2</title>
<polygon fill="none" stroke="black" points="549,-422 500.495,-404 549,-386 597.505,-404 549,-422"/>
<text text-anchor="middle" x="549" y="-400.9" font-family="Times,serif" font-size="12.00">sha256d</text>
</g>
<!-- root1 -->
<g id="node25" class="node"><title>root1</title>
<polygon fill="none" stroke="black" points="589,-480 509,-480 509,-444 589,-444 589,-480"/>
<text text-anchor="middle" x="549" y="-458.3" font-family="Times,serif" font-size="14.00">e5e7...c429</text>
</g>
<!-- hashop2&#45;&gt;root1 -->
<g id="edge27" class="edge"><title>hashop2&#45;&gt;root1</title>
<path fill="none" stroke="black" d="M549,-422.106C549,-425.797 549,-429.787 549,-433.757"/>
<polygon fill="black" stroke="black" points="545.5,-433.999 549,-443.999 552.5,-433.999 545.5,-433.999"/>
</g>
<!-- tx0 -->
<g id="node26" class="node"><title>tx0</title>
<polygon fill="none" stroke="black" points="502,-98 424,-98 424,-62 502,-62 502,-98"/>
<text text-anchor="middle" x="463" y="-76.3" font-family="Times,serif" font-size="14.00">0100...cdef</text>
</g>
<!-- hashop1 -->
<g id="node28" class="node"><title>hashop1</title>
<polygon fill="none" stroke="black" points="463,-156 414.495,-138 463,-120 511.505,-138 463,-156"/>
<text text-anchor="middle" x="463" y="-134.9" font-family="Times,serif" font-size="12.00">sha256d</text>
</g>
<!-- tx0&#45;&gt;hashop1 -->
<g id="edge19" class="edge"><title>tx0&#45;&gt;hashop1</title>
<path fill="none" stroke="black" d="M463,-98.1061C463,-101.797 463,-105.787 463,-109.757"/>
<polygon fill="black" stroke="black" points="459.5,-109.999 463,-119.999 466.5,-109.999 459.5,-109.999"/>
</g>
<!-- txid0 -->
<g id="node27" class="node"><title>txid0</title>
<polygon fill="none" stroke="black" points="568,-216 358,-216 358,-178 568,-178 568,-216"/>
<text text-anchor="middle" x="463" y="-200.8" font-family="Times,serif" font-size="14.00">????????01??????????????????????</text>
<text text-anchor="middle" x="463" y="-185.8" font-family="Times,serif" font-size="14.00">????????????????????????????????</text>
</g>
<!-- txid0&#45;&gt;concat -->
<g id="edge21" class="edge"><title>txid0&#45;&gt;concat</title>
<path fill="none" stroke="black" d="M490.211,-216.035C500.487,-222.846 512.161,-230.583 522.382,-237.358"/>
<polygon fill="black" stroke="black" points="520.65,-240.409 530.919,-243.016 524.517,-234.574 520.65,-240.409"/>
</g>
<!-- hashop1&#45;&gt;txid0 -->
<g id="edge20" class="edge"><title>hashop1&#45;&gt;txid0</title>
<path fill="none" stroke="black" d="M463,-156.102C463,-159.725 463,-163.643 463,-167.56"/>
<polygon fill="black" stroke="black" points="459.5,-167.72 463,-177.72 466.5,-167.72 459.5,-167.72"/>
</g>
<!-- intermediate -->
<g id="node29" class="node"><title>intermediate</title>
<polygon fill="none" stroke="black" points="655,-364 443,-364 443,-296 655,-296 655,-364"/>
<text text-anchor="middle" x="549" y="-348.8" font-family="Times,serif" font-size="14.00">????????01??????????????????????</text>
<text text-anchor="middle" x="549" y="-333.8" font-family="Times,serif" font-size="14.00">????????????????????????????????</text>
<text text-anchor="middle" x="549" y="-318.8" font-family="Times,serif" font-size="14.00">??????????????????00????????01??</text>
<text text-anchor="middle" x="549" y="-303.8" font-family="Times,serif" font-size="14.00">??????????????04????????????????</text>
</g>
<!-- intermediate&#45;&gt;hashop2 -->
<g id="edge26" class="edge"><title>intermediate&#45;&gt;hashop2</title>
<path fill="none" stroke="black" d="M549,-364.05C549,-367.938 549,-371.873 549,-375.671"/>
<polygon fill="black" stroke="black" points="545.5,-375.86 549,-385.86 552.5,-375.86 545.5,-375.86"/>
</g>
<!-- hashop3&#45;&gt;txid1 -->
<g id="edge23" class="edge"><title>hashop3&#45;&gt;txid1</title>
<path fill="none" stroke="black" d="M692,-156.102C692,-159.725 692,-163.643 692,-167.56"/>
<polygon fill="black" stroke="black" points="688.5,-167.72 692,-177.72 695.5,-167.72 688.5,-167.72"/>
</g>
<!-- concat&#45;&gt;intermediate -->
<g id="edge25" class="edge"><title>concat&#45;&gt;intermediate</title>
<path fill="none" stroke="black" d="M549,-274.063C549,-277.656 549,-281.601 549,-285.677"/>
<polygon fill="black" stroke="black" points="545.5,-285.952 549,-295.952 552.5,-285.952 545.5,-285.952"/>
</g>
</g>
</svg>
